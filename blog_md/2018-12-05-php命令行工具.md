---
title: phpå‘½ä»¤è¡Œå·¥å…·
date: 2018-12-05 21:00:44
tags:
- php
- å‘½ä»¤è¡Œ
- å·¥å…·
---
### composeré•œåƒ
composerå…¨å±€å®‰è£…çš„å‘½ä»¤è·¯å¾„ C:\Users\xxx\AppData\Roaming\Composer\vendor\bin
```javascript
composer global require slince/composer-registry-manager
$ composer repo:ls
   composer       https://packagist.org
   phpcomposer    https://packagist.phpcomposer.com
   composer-proxy https://packagist.composer-proxy.org
 * laravel-china  https://packagist.laravel-china.org
   cnpkg          https://php.cnpkg.org
composer repo:use laravel-china
composer require å®‰è£…çš„æ—¶å€™å¯èƒ½ä¼šæŠŠ.gitç›®å½•ä¹Ÿä¸‹è½½äº†ï¼Œå› ä¸ºæœ¨æœ‰php-zipæ‰©å±•ï¼Œæ‰€ä»¥ä½¿ç”¨çš„git clone æ¥ä¸‹è½½ï¼Œé»˜è®¤æ˜¯wget
```
### httpstat
```javascript
$ git clone https://github.com/talhasch/php-httpstat
$ cd php-httpstat
$ cp httpstat.php /usr/local/bin/httpstat
$ chmod +x /usr/local/bin/httpstat
 

$ httpstat http://www.google.com
```
### PHP é™æ€ä»£ç åˆ†æphan
```javascript
https://laravel-china.org/topics/19011 https://github.com/nunomaduro/larastan https://laravel-china.org/topics/20768

git clone https://github.com/nikic/php-ast
cd php-ast/
phpize
sudo ./configure --with-php-config=/php7/bin/php-config --enable-ast
sudo make
sudo make install
php7 --ini
vi /etc/php.ini 
extension = ast.so
# å°±èƒ½çœ‹åˆ°æ‰©å±•å•¦
php -m | grep ast
curl -sS https://getcomposer.org/installer | php7
mkdir test
cd test
which php
$ composer config -g repo.packagist composer https://packagist.laravel-china.org

php7 /usr/bin/composer require --dev "phan/phan:1.x"
vi src/a.php
   
   <?php
   
   class A extends B
   {
       public function a1()
       {
           return $this->a2(1);
       }
   
       /**
        * @param array $b
        *
        * @return int
        */
       private function a2($b)
       {
           return $b + 1;
       }
   }
   å†™ä¸ªshellè„šæœ¬ vi test.sh 
   
   #!/bin/bash
   
   function log()
   {
       echo -e -n "\033[01;35m[YUNQI] \033[01;31m"
       echo $@
       echo -e -n "\033[00m"
   }
   
   Color_Text()
   {
     echo -e " \e[0;$2m$1\e[0m"
   }
   
   Echo_Red()
   {
     echo $(Color_Text "$1" "31")
   }
   
   Echo_Green()
   {
     echo $(Color_Text "$1" "32")
   }
   
   Echo_Yellow()
   {
     echo $(Color_Text "$1" "33")
   }
   
   : > file.list
   
   for file in $(ls src/*)
   do
     echo $file >> file.list
   done
   
   Echo_Green "file list:\n"
   Echo_Green "========================\n"
   
   cat file.list
   
   Echo_Green "========================\n"
   
   
   Echo_Yellow "Phan run\n"
   Echo_Yellow "========================\n"
   
   ./vendor/bin/phan -f file.list -o res.out
   
   Echo_Yellow "========================\n"
   
   Echo_Red "error log\n"
   Echo_Red "========================\n"
   
   cat res.out
   
   Echo_Red "========================\n"
   #https://mengkang.net/1356.html 
   [root@localhost ast]# sh test.sh
   file list:
   ========================
   src/a.php
   ========================
   Phan run
   ========================
   PHP Warning:  Unsupported declare 'strict_types' in /ast/vendor/phan/phan/src/phan.php on line 1
   PHP Parse error:  syntax error, unexpected T_FUNCTION, expecting T_PAAMAYIM_NEKUDOTAYIM in /ast/vendor/phan/phan/src/phan.php on line 29
   ========================
   error log
   ========================
   cat: res.out: No such file or directory
   ========================

   
   [root@localhost ast]# vi vendor/bin/phan
   #!/usr/bin/env php7
   <?php require_once __DIR__ . '/src/phan.php';
  # å®‰è£…
  composer require --dev nunomaduro/larastan
  
  # åˆ†æä»£ç 
  php artisan code:analyse
  è€Œ code:analyse å‘½ä»¤æœ‰äº›å‚æ•°å¯ä»¥å¸®åŠ©ä½ è‡ªå®šä¹‰åˆ†æè¿‡ç¨‹ã€‚
  
  # é»˜è®¤ä¸º 5ã€‚0 è¡¨ç¤ºæœ€å®½æ¾ï¼Œ7 è¡¨ç¤ºæœ€ä¸¥æ ¼ã€‚
  php artisan code:analyse --level=[0-7]
  
  # åˆ†ææŒ‡å®šçš„è·¯å¾„ã€‚
  php artisan code:analyse --paths="modules,app,domain" 
   å®‰è£…çš„æ—¶å€™å¦‚æœå‡ºç°æç¤º Your requirements could not be resolved to an installable set of packages.
   æ”¹ç”¨ä»¥ä¸‹çš„å‘½ä»¤å®‰è£…
   å…ˆæ‰§è¡Œ composer update
   å†æ‰§è¡Œ composer require nunomaduro/larastan --update-with-all-dependencies
```
### phpcs

### phpmd
### è¯­æ³•æ£€æµ‹
```javascript
composer require overtrue/phplint --dev -vvv
$ ./vendor/bin/phplint ./ --exclude=vendor
$ ./vendor/bin/phplint

```
### psysh
### ç®¡ç†ç¼“å­˜
```javascript
https://learnku.com/articles/26314
$ curl -sO http://gordalina.github.io/cachetool/downloads/cachetool.phar

$ chmod +x cachetool.phar

$ php cachetool.phar opcache:reset --fcgi
```
### php7ccè¯­æ³•æ£€æµ‹
```javascript
//https://github.com/sstalle/php7cc/releases
composer global require sstalle/php7cc
export PATH="$PATH:$HOME/.config/composer/vendor/bin"
php7cc /path/to/my/file.php
php7cc /path/to/my/directory/
php7cc --level=error /path/to/my/directory/ > error.txt

```

### spike

### phpcbf
### åŠ é€Ÿcomposerå¼€å¯å¤šçº¿ç¨‹å®‰è£…ä¸‹è½½
```javascript
$ composer global require hirak/prestissimo
$ composer global remove hirak/prestissimo
$ composer create-project laravel/laravel laravel1 --no-progress --profile --prefer-dist
```
### åŒ…æ„å»ºå·¥å…·package-builder
```javascript
//
å®‰è£…å·¥å…·

$ composer global require 'overtrue/package-builder' --prefer-source
åˆ›å»ºé¡¹ç›®

$ package-builder build [ç›®æ ‡ç›®å½•]
$ package-builder build ./weather
# ç„¶åæŒ‰æç¤ºæ“ä½œå³å¯
# åŒ…åï¼šxkeyi/weather
# å‘½åç©ºé—´ï¼šXkeyi\Weather 
# æè¿°ï¼šA weather SDK
æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ composer.json ä¸­å£°æ˜åŒ…è‡ªåŠ¨åŠ è½½çš„å‘½åç©ºé—´ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šcomposer dump-autoload
```
### pecl
```javascript
pecl install swoole é»˜è®¤æ˜¯æŒ‰ç…§æœ€æ–°ç‰ˆçš„ï¼Œå¦‚æœæœ‰ä½ çš„ç¯å¢ƒphpä¸æ˜¯æœ€æ–°ï¼Œé‚£éœ€è¦æŒ‰ç…§PHPç‰ˆæœ¬å»å®‰è£…
å®‰è£…PHPæ˜¯7.1ç‰ˆæœ¬çš„swoole
pecl -d php_suffix=7.1 install swoole-1.9.23
pecl channel-update pecl.php.net
```
### ç»çº¬åº¦è¡Œæ”¿åŒºåŸŸæŸ¥è¯¢
```javascript

curl "http://116.196.105.215:1234/gis?auth_user=freevip&latitude=39.880655&longitude=116.354386"
{"error":0,"msg":"æˆåŠŸ","data":{"country":"CHN","en0":"","en1":"","en2":"","en3":"","zh0":"ä¸­å›½","zh1":"åŒ—äº¬å¸‚","zh2":"","zh3":"è¥¿åŸåŒº"}}
```
### æ ¼å¼åŒ– SQL
```javascript
composer global require jdorn/sql-formatter

sql-formatter "SELECT SOME QUERY;" // ç›´æ¥æ ¼å¼åŒ–

// æˆ–

echo "SELECT SOME QUERY;" | sql-formatter // ä½¿ç”¨ç®¡é“ï¼Œæ›´é€‚åˆè¾ƒå¤§é‡çš„ SQL è¯­å¥

```
### å°† PHP åº”ç”¨å¿«é€Ÿæ‰“åŒ…ä¸º PHAR
```javascript
composer require humbug/box
vendor/bin/box compile 
[root@VM_0_14_centos blog]# vendor/bin/box compile

    ____
   / __ )____  _  __
  / __  / __ \| |/_/
 / /_/ / /_/ />  <
/_____/\____/_/|_|


Box version 3.4.0@4eeb285


 // Loading without a configuration file.


In Assertion.php line 2550:

  File "/usr/share/nginx/html/blog/index.php" was expected to exist.


compile [-c|--config CONFIG] [--debug] [--no-parallel] [--no-restart] [--dev] [--no-config] [--with-docker] [-d|--working-dir WORKING-DIR]


 [ERROR] The configuration file is invalid.
[root@VM_0_14_centos blog]# touch index.php
[root@VM_0_14_centos blog]# vendor/bin/box compile

    ____
   / __ )____  _  __
  / __  / __ \| |/_/
 / /_/ / /_/ />  <
/_____/\____/_/|_|


Box version 3.4.0@4eeb285


 // Loading without a configuration file.

ğŸ”¨  Building the PHAR "/usr/share/nginx/html/blog/index.phar"

? No compactor to register
? Adding main file: /usr/share/nginx/html/blog/index.php
? Adding requirements checker
? Adding binary files
    > No file found
? Auto-discover files? Yes
? Adding files
    > 4828 file(s)
? Generating new stub
  - Using shebang line: #!/usr/bin/env php
  - Using banner:
    > Generated by Humbug Box 3.4.0@4eeb285.
    >
    > @link https://github.com/humbug/box
? Dumping the Composer autoloader
? Removing the Composer dump artefacts
? No compression
? Setting file permissions to 0755
* Done.

No recommendation found.
No warning found.

 // PHAR: 4865 files (24.51MB)
 // You can inspect the generated PHAR with the "info" command.

 // Memory usage: 83.76MB (peak: 85.63MB), time: 109.71s
```
### phptrace
```javascript
wget https://github.com/Qihoo360/phptrace/archive/v1.0.1-beta.tar.gz
tar -zxvf v1.0.1-beta.tar.gz
cd phptrace-1.0.1-beta/extension
/usr/local/php/bin/phpize
./configure --with-php-config=/usr/local/php/bin/php-config
make
make install-all
See any operating system documentation about shared libraries for
more information, such as the ld(1) and ld.so(8) manual pages.
----------------------------------------------------------------------
Installing shared extensions:     /usr/local/php/lib/php/extensions/no-debug-non-zts-20170718/
Installing PHP Trace binary:      /usr/local/php/bin/
[root@VM_0_14_centos extension]# php --ini
Configuration File (php.ini) Path: /usr/local/php/lib
Loaded Configuration File:         /usr/local/php/lib/php.ini
Scan for additional .ini files in: (none)
Additional .ini files parsed:      (none)
vi /usr/local/php/lib/php.ini
extension = trace.so
 /usr/local/php/bin/phptrace -p 19248
```
### gdb
```javascript
for ($i = 0; $i < 3; $i ++) {
    echo $i . PHP_EOL;
    if ($i == 2) {
        $j = $i + 1;
        var_dump($j);
    }
    sleep(1);
}
gdb php
(gdb)run index.php
...
0
1
2
int(3)
[Inferior 1 (process 577) exited normally]

```
### curl
```javascript
curl -x 123.45.67.89:1080 -o page.html http://www.yahoo.com ä½¿ç”¨ä»£ç†è®¿é—®
æ·»åŠ  --data æˆ– -D åé¢è·Ÿä¼ é€’çš„å‚æ•°ï¼Œå†åŠ ç½‘å€ï¼Œå³å¯å‘é€POSTè¯·æ±‚

curl -D "name=jack&age=22" 127.0.0.1:8899/post
å¦‚æœè¦å¯¹æ•°æ®å†…å®¹åšç¼–ç å¤„ç†ï¼Œå¯ä½¿ç”¨ â€“data-urlencode å‚æ•°

curl -D "name=jack jason&age=22" 127.0.0.1:8899/post
curl --e http://www.example.com http://www.example.com
ç”¨curlé€šè¿‡dictåè®®å»æŸ¥å­—å…¸
curl dict://dict.org/d:computer
ftpä¸‹è½½ä¸Šä¼ 
curl -u name:passwd ftp://ip:port/path/file

curl -T localfile -u name:passwd ftp://upload_site:port/path/
```
[php ä¸­ä½¿ç”¨ straceã€gdbã€tcpdump è°ƒè¯•å·¥å…·](http://www.syyong.com/php/Using-strace-GDB-and-tcpdump-debugging-tools-in-PHP.html)

[PHP ä¸­æ ¼å¼åŒ–å¹¶é«˜äº® SQL è¯­å¥](https://laravel-china.org/articles/22230)

[ä¸ºä»€ä¹ˆ (int) å¿«äº intval?](http://www.syyong.com/php/Why-is-int-faster-than-intval.html)

[å°† PHP åº”ç”¨å¿«é€Ÿæ‰“åŒ…ä¸º PHAR](https://laravel-china.org/articles/22370)

[PHP 7çš„æ–°ç‰¹æ€§](https://github.com/wuxu92/PHP7-Reference-cn)

[MACä¹‹httpå‘½ä»¤è¡Œå·¥å…·curl](http://coderlt.coding.me/2016/03/22/mac-command-curl/)

[ PHPå®ç°è®¢å•çš„å»¶æ—¶å¤„ç†](https://segmentfault.com/a/1190000012641373)

[30-seconds-of-php-code](https://github.com/appzcoder/30-seconds-of-php-code)

[composerå›¾æ ‡](https://poser.pugx.org/)

[ç”¨PHPç©è½¬è¿›ç¨‹ä¹‹äºŒ â€” å¤šè¿›ç¨‹PHPServer](https://www.fanhaobai.com/2018/09/process-php-multiprocess-server.html)